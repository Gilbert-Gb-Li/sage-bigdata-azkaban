#!/bin/sh
source /etc/profile
source ${AZKABAN_HOME}/conf/env.conf
source ${base_path}/util.sh

date=$1
yesterday=`date -d "-1 day $date" +%Y-%m-%d`


hive_sql=`cat << EOF
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition(dt='$date', hour='00') location '/data/uxin/origin/car_parameter/$date/00';
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition (dt='$date', hour='01') location '/data/uxin/origin/car_parameter/$date/01';
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition (dt='$date', hour='02') location '/data/uxin/origin/car_parameter/$date/02';
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition (dt='$date', hour='03') location '/data/uxin/origin/car_parameter/$date/03';
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition (dt='$date', hour='04') location '/data/uxin/origin/car_parameter/$date/04';
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition (dt='$date', hour='05') location '/data/uxin/origin/car_parameter/$date/05';
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition (dt='$date', hour='06') location '/data/uxin/origin/car_parameter/$date/06';
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition (dt='$date', hour='07') location '/data/uxin/origin/car_parameter/$date/07';
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition (dt='$date', hour='08') location '/data/uxin/origin/car_parameter/$date/08';
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition (dt='$date', hour='09') location '/data/uxin/origin/car_parameter/$date/09';
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition (dt='$date', hour='10') location '/data/uxin/origin/car_parameter/$date/10';
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition (dt='$date', hour='11') location '/data/uxin/origin/car_parameter/$date/11';
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition (dt='$date', hour='12') location '/data/uxin/origin/car_parameter/$date/12';
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition (dt='$date', hour='13') location '/data/uxin/origin/car_parameter/$date/13';
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition (dt='$date', hour='14') location '/data/uxin/origin/car_parameter/$date/14';
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition (dt='$date', hour='15') location '/data/uxin/origin/car_parameter/$date/15';
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition (dt='$date', hour='16') location '/data/uxin/origin/car_parameter/$date/16';
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition (dt='$date', hour='17') location '/data/uxin/origin/car_parameter/$date/17';
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition (dt='$date', hour='18') location '/data/uxin/origin/car_parameter/$date/18';
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition (dt='$date', hour='19') location '/data/uxin/origin/car_parameter/$date/19';
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition (dt='$date', hour='20') location '/data/uxin/origin/car_parameter/$date/20';
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition (dt='$date', hour='21') location '/data/uxin/origin/car_parameter/$date/21';
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition (dt='$date', hour='22') location '/data/uxin/origin/car_parameter/$date/22';
alter table bigdata.uxin_car_parameter_origin add IF NOT EXISTS partition (dt='$date', hour='23') location '/data/uxin/origin/car_parameter/$date/23';
EOF`

hive_sql=" "
executeHiveCommand "${hive_sql}"

hive_sql="alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='00') location '/data/uxin/origin/car_payment/${date}/00'; alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='01') location '/data/uxin/origin/car_payment/${date}/01'; alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='02') location '/data/uxin/origin/car_payment/${date}/02'; alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='03') location '/data/uxin/origin/car_payment/${date}/03'; alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='04') location '/data/uxin/origin/car_payment/${date}/04'; alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='05') location '/data/uxin/origin/car_payment/${date}/05'; alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='06') location '/data/uxin/origin/car_payment/${date}/06'; alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='07') location '/data/uxin/origin/car_payment/${date}/07'; alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='08') location '/data/uxin/origin/car_payment/${date}/08'; alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='09') location '/data/uxin/origin/car_payment/${date}/09'; alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='10') location '/data/uxin/origin/car_payment/${date}/10'; alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='11') location '/data/uxin/origin/car_payment/${date}/11'; alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='12') location '/data/uxin/origin/car_payment/${date}/12'; alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='13') location '/data/uxin/origin/car_payment/${date}/13'; alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='14') location '/data/uxin/origin/car_payment/${date}/14'; alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='15') location '/data/uxin/origin/car_payment/${date}/15'; alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='16') location '/data/uxin/origin/car_payment/${date}/16'; alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='17') location '/data/uxin/origin/car_payment/${date}/17'; alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='18') location '/data/uxin/origin/car_payment/${date}/18'; alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='19') location '/data/uxin/origin/car_payment/${date}/19'; alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='20') location '/data/uxin/origin/car_payment/${date}/20'; alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='21') location '/data/uxin/origin/car_payment/${date}/21'; alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='22') location '/data/uxin/origin/car_payment/${date}/22'; alter table bigdata.uxin_car_payment_origin add IF NOT EXISTS partition (dt='${date}', hour='23') location '/data/uxin/origin/car_payment/${date}/23';"
executeHiveCommand "${hive_sql}"

hive_sql="alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='00') location '/data/uxin/origin/car_price_analysis/${date}/00'; alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='01') location '/data/uxin/origin/car_price_analysis/${date}/01'; alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='02') location '/data/uxin/origin/car_price_analysis/${date}/02'; alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='03') location '/data/uxin/origin/car_price_analysis/${date}/03'; alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='04') location '/data/uxin/origin/car_price_analysis/${date}/04'; alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='05') location '/data/uxin/origin/car_price_analysis/${date}/05'; alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='06') location '/data/uxin/origin/car_price_analysis/${date}/06'; alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='07') location '/data/uxin/origin/car_price_analysis/${date}/07'; alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='08') location '/data/uxin/origin/car_price_analysis/${date}/08'; alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='09') location '/data/uxin/origin/car_price_analysis/${date}/09'; alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='10') location '/data/uxin/origin/car_price_analysis/${date}/10'; alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='11') location '/data/uxin/origin/car_price_analysis/${date}/11'; alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='12') location '/data/uxin/origin/car_price_analysis/${date}/12'; alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='13') location '/data/uxin/origin/car_price_analysis/${date}/13'; alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='14') location '/data/uxin/origin/car_price_analysis/${date}/14'; alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='15') location '/data/uxin/origin/car_price_analysis/${date}/15'; alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='16') location '/data/uxin/origin/car_price_analysis/${date}/16'; alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='17') location '/data/uxin/origin/car_price_analysis/${date}/17'; alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='18') location '/data/uxin/origin/car_price_analysis/${date}/18'; alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='19') location '/data/uxin/origin/car_price_analysis/${date}/19'; alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='20') location '/data/uxin/origin/car_price_analysis/${date}/20'; alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='21') location '/data/uxin/origin/car_price_analysis/${date}/21'; alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='22') location '/data/uxin/origin/car_price_analysis/${date}/22'; alter table bigdata.uxin_car_price_analysis_origin add IF NOT EXISTS partition (dt='${date}', hour='23') location '/data/uxin/origin/car_price_analysis/${date}/23';"
executeHiveCommand "${hive_sql}"

hive_sql="alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='00') location '/data/uxin/origin/car_off_sale/${date}/00'; alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='01') location '/data/uxin/origin/car_off_sale/${date}/01'; alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='02') location '/data/uxin/origin/car_off_sale/${date}/02'; alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='03') location '/data/uxin/origin/car_off_sale/${date}/03'; alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='04') location '/data/uxin/origin/car_off_sale/${date}/04'; alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='05') location '/data/uxin/origin/car_off_sale/${date}/05'; alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='06') location '/data/uxin/origin/car_off_sale/${date}/06'; alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='07') location '/data/uxin/origin/car_off_sale/${date}/07'; alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='08') location '/data/uxin/origin/car_off_sale/${date}/08'; alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='09') location '/data/uxin/origin/car_off_sale/${date}/09'; alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='10') location '/data/uxin/origin/car_off_sale/${date}/10'; alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='11') location '/data/uxin/origin/car_off_sale/${date}/11'; alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='12') location '/data/uxin/origin/car_off_sale/${date}/12'; alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='13') location '/data/uxin/origin/car_off_sale/${date}/13'; alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='14') location '/data/uxin/origin/car_off_sale/${date}/14'; alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='15') location '/data/uxin/origin/car_off_sale/${date}/15'; alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='16') location '/data/uxin/origin/car_off_sale/${date}/16'; alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='17') location '/data/uxin/origin/car_off_sale/${date}/17'; alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='18') location '/data/uxin/origin/car_off_sale/${date}/18'; alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='19') location '/data/uxin/origin/car_off_sale/${date}/19'; alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='20') location '/data/uxin/origin/car_off_sale/${date}/20'; alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='21') location '/data/uxin/origin/car_off_sale/${date}/21'; alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='22') location '/data/uxin/origin/car_off_sale/${date}/22'; alter table bigdata.uxin_car_off_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='23') location '/data/uxin/origin/car_off_sale/${date}/23';"
executeHiveCommand "${hive_sql}"

hive_sql="alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='00') location '/data/uxin/origin/car_had_sale/${date}/00'; alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='01') location '/data/uxin/origin/car_had_sale/${date}/01'; alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='02') location '/data/uxin/origin/car_had_sale/${date}/02'; alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='03') location '/data/uxin/origin/car_had_sale/${date}/03'; alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='04') location '/data/uxin/origin/car_had_sale/${date}/04'; alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='05') location '/data/uxin/origin/car_had_sale/${date}/05'; alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='06') location '/data/uxin/origin/car_had_sale/${date}/06'; alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='07') location '/data/uxin/origin/car_had_sale/${date}/07'; alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='08') location '/data/uxin/origin/car_had_sale/${date}/08'; alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='09') location '/data/uxin/origin/car_had_sale/${date}/09'; alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='10') location '/data/uxin/origin/car_had_sale/${date}/10'; alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='11') location '/data/uxin/origin/car_had_sale/${date}/11'; alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='12') location '/data/uxin/origin/car_had_sale/${date}/12'; alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='13') location '/data/uxin/origin/car_had_sale/${date}/13'; alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='14') location '/data/uxin/origin/car_had_sale/${date}/14'; alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='15') location '/data/uxin/origin/car_had_sale/${date}/15'; alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='16') location '/data/uxin/origin/car_had_sale/${date}/16'; alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='17') location '/data/uxin/origin/car_had_sale/${date}/17'; alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='18') location '/data/uxin/origin/car_had_sale/${date}/18'; alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='19') location '/data/uxin/origin/car_had_sale/${date}/19'; alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='20') location '/data/uxin/origin/car_had_sale/${date}/20'; alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='21') location '/data/uxin/origin/car_had_sale/${date}/21'; alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='22') location '/data/uxin/origin/car_had_sale/${date}/22'; alter table bigdata.uxin_car_had_sale_origin add IF NOT EXISTS partition (dt='${date}', hour='23') location '/data/uxin/origin/car_had_sale/${date}/23';"
executeHiveCommand "${hive_sql}"