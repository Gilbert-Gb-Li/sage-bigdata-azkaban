{"id":"804e842b-d408-416d-9ef3-9a1d8798cfc7","name":"食药监-饿了么商家数据","sample":"","parser":{"filter":[{"field":"data","parser":{"filter":[{"field":"data","name":"extends"}],"metadata":[],"name":"json"},"ref":"392f13a1-4f4e-41d3-be1d-8c1ab9d78a57","name":"reParser"},{"script":"import java.text.SimpleDateFormat\nimport java.util.Date\nimport java.util.regex.Pattern\nimport com.haima.sage.bigdata.etl.common.model.RichMap\n\nvar result = RichMap()\nresult ++= event\n\n//补hdfs存储目录\nval currentPage_province_city = result.get(\"currentPage_province_city\").orNull\nval currentPage = currentPage_province_city.split(\"_\")(0)\nval province = currentPage_province_city.split(\"_\")(1)\nval city = currentPage_province_city.split(\"_\")(2)\n\nresult ++= Map(\"currentPage\" -> currentPage)\nresult ++= Map(\"province\" -> province)\nresult ++= Map(\"city\" -> city)\nresult","type":"scala","name":"script"},{"fields":["shop_min_order_amount","shop_rating","shop_supportSelfTaking","shop_delivery_price","shop_label_icon","shop_recent_food_popularity","categories"],"name":"removeFields"},{"fields":["current_page","restaurant_id"],"name":"removeFields"},{"fields":{"openHours":"open_time"},"name":"mapping"}],"metadata":[],"name":"json"},"properties":[],"isSample":0}