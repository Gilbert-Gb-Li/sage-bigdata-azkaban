{"id":"52327ac2-f4b3-476c-926c-28db7a3e77bb","name":"食药监-美团ES-评论详情汇总更新","writeType":"es6","data":{"cluster":"NX_ES","hostPorts":[["MVP-HADOOP40",9200]],"index":"tbl_es_takeout_shop_info1","indexType":"data","idFields":"shop_id","isScript":true,"script":"ctx._source.comment_total_num = params.comment_total_num;  \nif(ctx._source.bad_comment_total_num==null){\n    ctx._source.bad_comment_total_num =params.bad_comment_total_num;\n}else{\nctx._source.bad_comment_total_num += params.bad_comment_total_num;    \n}\nif(ctx._source.key_word_fly_num==null){\n    ctx._source.key_word_fly_num =params.key_word_fly_num;\n}else{\nctx._source.key_word_fly_num += params.key_word_fly_num;    \n}\nif(ctx._source.key_word_hair_num==null){\n    ctx._source.key_word_hair_num =params.key_word_hair_num;\n}else{\nctx._source.key_word_hair_num += params.key_word_hair_num;    \n}\nif(ctx._source.key_word_nfresh_num==null){\n    ctx._source.key_word_nfresh_num =params.key_word_nfresh_num;\n}else{\nctx._source.key_word_nfresh_num += params.key_word_nfresh_num;  \n}\n\nif(ctx._source.comment_total_num !== null){\n    float bad_comment_total_num = ctx._source.bad_comment_total_num;\n    float comment_total_num = ctx._source.comment_total_num;\n    ctx._source.bad_comment_rate = bad_comment_total_num / comment_total_num\n}else{\n    ctx._source.bad_comment_rate = 0\n}\n\nctx._source.key_word_total=ctx._source.key_word_fly_num + ctx._source.key_word_hair_num + ctx._source.key_word_nfresh_num\n","number_of_shards":5,"number_of_replicas":1,"numeric_detection":false,"date_detection":true,"enable_size":false,"persisRef":{"name":"none"},"name":"es6","cache":1000},"isSample":0}